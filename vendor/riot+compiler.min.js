/* Riot v2.0.10, @license MIT, (c) 2015 Muut Inc. + contributors */
(function(){var e={version:"v2.0.10",settings:{}};"use strict";e.observable=function(e){e=e||{};var t={},n=0;e.on=function(r,i){if(typeof i=="function"){i._id=n++;r.replace(/\S+/g,function(e,n){(t[e]=t[e]||[]).push(i);i.typed=n>0})}return e};e.off=function(n,r){if(n=="*")t={};else if(r){var i=t[n];for(var o=0,u;u=i&&i[o];++o){if(u._id==r._id){i.splice(o,1);o--}}}else{n.replace(/\S+/g,function(e){t[e]=[]})}return e};e.one=function(t,n){if(n)n.one=1;return e.on(t,n)};e.trigger=function(n){var r=[].slice.call(arguments,1),i=t[n]||[];for(var o=0,u;u=i[o];++o){if(!u.busy){u.busy=1;u.apply(e,u.typed?[n].concat(r):r);if(u.one){i.splice(o,1);o--}else if(i[o]!==u){o--}u.busy=0}}return e};return e};(function(e,t){if(!this.top)return;var n=location,r=e.observable(),i=window,o;function u(){return n.hash.slice(1)}function a(e){return e.split("/")}function f(e){if(e.type)e=u();if(e!=o){r.trigger.apply(null,["H"].concat(a(e)));o=e}}var c=e.route=function(e){if(e[0]){n.hash=e;f(e)}else{r.on("H",e)}};c.exec=function(e){e.apply(null,a(u()))};c.parser=function(e){a=e};i.addEventListener?i.addEventListener(t,f,false):i.attachEvent("on"+t,f)})(e,"hashchange");var t=function(t,n,r){return function(i){n=e.settings.brackets||t;if(r!=n)r=n.split(" ");return i&&i.test?n==t?i:RegExp(i.source.replace(/\{/g,r[0].replace(/(?=.)/g,"\\")).replace(/\}/g,r[1].replace(/(?=.)/g,"\\")),i.global?"g":""):r[i]}}("{ }");var n=function(){var e={},n=/({[\s\S]*?})/,r=/(['"\/]).*?[^\\]\1|\.\w*|\w*:|\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\b|function *\()|([a-z_]\w*)/gi;return function(t,n){return t&&(e[t]=e[t]||i(t))(n)};function i(e,r){r=(e||t(0)+t(1)).replace(t(/\\{/),"￰").replace(t(/\\}/),"￱").split(t(n));return new Function("d","return "+(!r[0]&&!r[2]&&!r[3]?o(r[1]):"["+r.map(function(e,t){return t%2?o(e,1):'"'+e.replace(/\n/g,"\\n").replace(/"/g,'\\"')+'"'}).join(",")+'].join("")').replace(/\uFFF0/g,t(0)).replace(/\uFFF1/g,t(1)))}function o(e,n){e=e.replace(/\n/g," ").replace(t(/^[{ ]+|[ }]+$|\/\*.+?\*\//g),"");return/^\s*[\w- "']+ *:/.test(e)?"["+e.replace(/\W*([\w- ]+)\W*:([^,]+)/g,function(e,t,n){return n.replace(/[^&|=!><]+/g,u)+'?"'+t.trim()+'":"",'})+'].join(" ")':u(e,n)}function u(e,t){e=e.trim();return!e?"":"(function(v){try{v="+(e.replace(r,function(e,t,n){return n?"(d."+n+"===undefined?window."+n+":d."+n+")":e})||"x")+"}finally{return "+(t?'!v&&v!==0?"":v':"v")+"}}).call(d)"}}();function r(e){var n={val:e},r=e.split(/\s+in\s+/);if(r[1]){n.val=t(0)+r[1];r=r[0].slice(t(0).length).trim().split(/,\s*/);n.key=r[0];n.pos=r[1]}return n}function i(e,t,n){var r={};r[e.key]=t;if(e.pos)r[e.pos]=n;return r}function o(e,t,o){d(e,"each");var u=e.outerHTML,a=e.previousSibling,c=e.parentNode,s=[],l=[],v;o=r(o);function m(e,t,n){s.splice(e,0,t);l.splice(e,0,n)}t.one("update",function(){c.removeChild(e)}).one("mount",function(){if(c.stub)c=t.root}).on("update",function(){var e=n(o.val,t);if(!e)return;if(!Array.isArray(e)){var r=JSON.stringify(e);if(r==v)return;v=r;p(l,function(e){e.unmount()});s=[];l=[];e=Object.keys(e).map(function(t){return i(o,t,e[t])})}p(h(s,e),function(e){var t=s.indexOf(e),n=l[t];if(n){n.unmount();s.splice(t,1);l.splice(t,1)}});var d=c.childNodes,g=[].indexOf.call(d,a);p(e,function(n,r){var a=e.indexOf(n,r),p=s.indexOf(n,r);a<0&&(a=e.lastIndexOf(n,r));p<0&&(p=s.lastIndexOf(n,r));if(p<0){if(!v&&o.key)n=i(o,n,a);var h=new f({tmpl:u},{before:d[g+1+a],parent:t,root:c,loop:true,item:n});return m(a,n,h)}if(o.pos&&l[p][o.pos]!=a){l[p].one("update",function(e){e[o.pos]=a});l[p].update()}if(a!=p){c.insertBefore(d[g+p+1],d[g+a+1]);return m(a,s.splice(p,1)[0],l.splice(p,1)[0])}});s=e.slice()})}function u(e,t,n){g(e,function(e){if(e.nodeType!=1)return;p(e.attributes,function(n){if(/^(name|id)$/.test(n.name))t[n.value]=e})})}function a(e,n,r){function i(e,n,i){if(n.indexOf(t(0))>=0){var o={dom:e,expr:n};r.push(v(o,i))}}g(e,function(e){var t=e.nodeType;if(t==3&&e.parentNode.tagName!="STYLE")i(e,e.nodeValue);if(t!=1)return;var r=e.getAttribute("each");if(r){o(e,n,r);return false}p(e.attributes,function(t){var n=t.name,r=t.value;var o=n.split("__")[1];i(e,r,{attr:o||n,bool:o});if(o){d(e,n);return false}});var u=w[e.tagName.toLowerCase()];if(u)u=new f(u,{root:e,parent:n})})}function f(r,i){var o=e.observable(this),f=[],c={},s=i.parent,g=i.loop,h=i.root,y=b(i.opts),w=i.item;if(!g&&h.riot)return;h.riot=1;y=y||{};v(this,{parent:s,root:h,opts:y});v(this,w);p(h.attributes,function(e){var n=e.name,r=e.value;c[n]=r;if(r.indexOf(t(0))>=0){d(h,n);return false}});function x(){p(Object.keys(c),function(e){y[e]=n(c[e],s||o)})}x();var k=m(r.tmpl),O;u(k,this);this.update=function(e,t){v(o,e);v(o,w);o.trigger("update",w);x();l(f,o,w);o.trigger("updated")};this.unmount=function(){var e=g?O:h,t=e.parentNode;if(t){t.removeChild(e);o.trigger("unmount");s&&s.off("update",o.update).off("unmount",o.unmount);o.off("*")}};function C(){if(g){O=k.firstChild;h.insertBefore(O,i.before||null)}else{while(k.firstChild)h.appendChild(k.firstChild)}if(h.stub)o.root=h=s.root;o.trigger("mount");s&&s.on("update",o.update).one("unmount",o.unmount)}if(r.fn)r.fn.call(this,y);a(k,this,f);this.update();C()}function c(e,t,n,r,i){n[e]=function(e){e=e||window.event;e.which=e.which||e.charCode||e.keyCode;e.target=e.target||e.srcElement;e.currentTarget=n;e.item=i;if(t.call(r,e)!==true){e.preventDefault&&e.preventDefault();e.returnValue=false}var o=i?r.parent:r;o.update()}}function s(e,t,n){if(e){e.insertBefore(n,t);e.removeChild(t)}}function l(e,t,r){p(e,function(e){var i=e.dom,o=e.attr,u=n(e.expr,t);if(u==null)u="";if(e.value===u)return;e.value=u;if(!o)return i.nodeValue=u;d(i,o);if(typeof u=="function"){c(o,u,i,t,r)}else if(o=="if"){var a=e.stub;if(u){a&&s(a.parentNode,a,i)}else{a=e.stub=a||document.createTextNode("");s(i.parentNode,i,a)}}else if(/^(show|hide)$/.test(o)){if(o=="hide")u=!u;i.style.display=u?"":"none"}else if(o=="value"){i.value=u}else if(o=="riot-src"){u?i.setAttribute("src",u):d(i,"src")}else{if(e.bool){i[o]=u;if(!u)return;u=o}i.setAttribute(o,u)}})}function p(e,t){for(var n=0,r=(e||[]).length,i;n<r;n++){i=e[n];if(i!=null&&t(i,n)===false)n--}}function d(e,t){e.removeAttribute(t)}function v(e,t){t&&p(Object.keys(t),function(n){e[n]=t[n]});return e}function m(e){var t=e.trim().slice(1,3).toLowerCase(),n=/td|th/.test(t)?"tr":t=="tr"?"tbody":"div",r=document.createElement(n);r.stub=true;r.innerHTML=e;return r}function g(e,t){e=t(e)===false?e.nextSibling:e.firstChild;while(e){g(e,t);e=e.nextSibling}}function h(e,t){return e.filter(function(e){return t.indexOf(e)<0})}function b(e){function t(){}t.prototype=e;return new t}var y=[],w={};function x(e){var t=document.createElement("style");t.innerHTML=e;document.head.appendChild(t)}e.tag=function(e,t,n,r){if(typeof n=="function")r=n;else if(n)x(n);w[e]={name:e,tmpl:t,fn:r}};var k=e.mountTo=function(e,t,n){var r=w[t],i;if(r&&e){e.riot=0;i=new f(r,{root:e,opts:n})}if(i){y.push(i);return i.on("unmount",function(){y.splice(y.indexOf(i),1)})}};e.mount=function(e,t){if(e=="*")e=Object.keys(w).join(", ");var n=[];p(document.querySelectorAll(e),function(e){if(e.riot)return;var r=e.tagName.toLowerCase(),i=k(e,r,t);if(i)n.push(i)});return n};e.update=function(){p(y,function(e){e.update()});return y};(function(t){var n=("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,"+"defaultchecked,defaultmuted,defaultselected,defer,disabled,draggable,enabled,formnovalidate,hidden,"+"indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,"+"pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,spellcheck,translate,truespeed,"+"typemustmatch,visible").split(",");var r="area,base,br,col,command,embed,hr,img,input,keygen,link,meta,param,source,track,wbr".split(",");var i={jade:O};var o={coffeescript:b,none:k,cs:b,es6:y,typescript:w,livescript:x,ls:x};var u=/^<([\w\-]+)>(.*)<\/\1>/gim,a=/=({[^}]+})([\s\/\>])/g,f=/([\w\-]+)=["']({[^}]+})["']/g,c=/{\s*([^}]+)\s*}/g,s=/^<([\w\-]+)>([^\x00]*[\w\/}]>$)?([^\x00]*?)^<\/\1>/gim,l=/<script(\s+type=['"]?([^>'"]+)['"]?)?>([^\x00]*?)<\/script>/gm,p=/<style(\s+type=['"]?([^>'"]+)['"]?)?>([^\x00]*?)<\/style>/gm,d=/<!--.*?-->/g,v=/<([\w\-]+)([^>]*)\/\s*>/g,m=/^\s*\/\/.*$/gm,g=/\/\*[^\x00]*?\*\//gm;function h(t,i,o){var u=e.util.brackets;t=t.replace(/\s+/g," ");t=t.trim().replace(d,"");t=t.replace(u(a),'="$1"$2');t=t.replace(u(f),function(e,t,r){t=t.toLowerCase();if(t=="src")t="riot-"+t;else if(n.indexOf(t)>=0)t="__"+t;return t+'="'+r+'"'});if(i.expr){t=t.replace(u(c),function(e,t){var n=T(t,i,o).trim().replace(/\r?\n|\r/g,"").trim();if(n.slice(-1)==";")n=n.slice(0,-1);return B[0]+n+B[1]})}t=t.replace(v,function(e,t,n){var i="<"+t+(n?" "+n.trim():"")+">";if(r.indexOf(t.toLowerCase())==-1)i+="</"+t+">";return i});t=t.replace(/'/g,"\\'");t=t.replace(u(/\\{|\\}/g),"\\$&");if(i.compact)t=t.replace(/> </g,"><");return t}function b(e){return require("coffee-script").compile(e,{bare:true})}function y(e){return require("babel").transform(e,{blacklist:["useStrict"]}).code}function w(e){return require("typescript-simple")(e)}function x(e){return require("LiveScript").compile(e,{bare:true,header:false})}function k(e){return e}function O(e){return require("jade").render(e,{pretty:true})}function C(e){e=e.replace(m,"").replace(g,"");var t=e.split("\n"),n="";t.forEach(function(e,r){var i=e.trim();if(i[0]!="}"&&i.indexOf("(")>0&&i.indexOf("function")==-1){var o=/[{}]/.exec(i.slice(-1)),u=o&&/(\s+)([\w]+)\s*\(([\w,\s]*)\)\s*\{/.exec(e);if(u&&!/^(if|while|switch|for)$/.test(u[2])){t[r]=u[1]+"this."+u[2]+" = function("+u[3]+") {";if(o[0]=="}"){t[r]+=" "+i.slice(u[0].length-1,-1)+"}.bind(this)"}else{n=u[1]}}}if(e.slice(0,n.length+1)==n+"}"){t[r]=n+"}.bind(this);";n=""}});return t.join("\n")}function T(e,t,n){var r=t.parser||(n?o[n]:C);if(!r)throw new Error('Parser not found "'+n+'"');return r(e,t)}function E(e,t){var n=i[e];if(!n)throw new Error('Template parser not found "'+e+'"');return n(t)}function L(e,t){e=e.replace(/\s+/g," ");e=e.trim();e=e.replace(/'/g,"\\'");return e}function S(e,t,n,r){return"riot.tag('"+e+"', '"+t+"'"+(n?", '"+n+"'":"")+", function(opts) {"+r+"\n});"}function j(t,n){n=n||{};if(n.brackets)e.settings.brackets=n.brackets;if(n.template)t=E(n.template,t);t=t.replace(u,function(e,t,r){return S(t,h(r,n),"")});return t.replace(s,function(e,t,r,i){r=r||"";var o=n.type;if(!i.trim()){r=r.replace(l,function(e,t,n,r){if(n)o=n.replace("text/","");i=r;return""})}var u="";var a="css";r=r.replace(p,function(e,t,n,r){if(n)a=n.replace("text/","");u=r;return""});return S(t,h(r,n,o),L(u,a),T(i,n,o))})}if(t){this.riot=require(process.env.RIOT||"../riot");return module.exports={html:h,compile:j}}var N=document,q,A;function $(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState==4&&n.status==200)t(n.responseText)};n.open("GET",e,true);n.send("")}function _(e){var t=/[ \t]+/.exec(e);if(t)e=e.replace(new RegExp("^"+t[0],"gm"),"");return e}function F(e){var t=N.createElement("script"),n=N.documentElement;t.text=j(e);n.appendChild(t);n.removeChild(t)}function H(e){var t=N.querySelectorAll('script[type="riot/tag"]');[].map.call(t,function(n,r){var i=n.getAttribute("src");function o(n){F(n);if(r+1==t.length){q.trigger("ready");A=true;e&&e()}}return i?$(i,o):o(_(n.innerHTML))})}e.compile=function(t,n){if(typeof t=="string"){if(t.trim()[0]=="<"){var r=_(j(t));if(!n)F(r);return r}else{return $(t,function(e){var t=_(j(e));F(t);n&&n(t,e)})}}if(typeof t!="function")t=undefined;if(A)return t&&t();if(q){t&&q.on("ready",t)}else{q=e.observable();H(t)}};var M=e.mount,I=e.mountTo;e.mount=function(t,n){var r;e.compile(function(){r=M(t,n)});return r};e.mountTo=function(t,n,r){var i;e.compile(function(){i=I(t,n,r)});return i}})(!this.top);e.util={brackets:t,tmpl:n};if(typeof exports==="object")module.exports=e;else if(typeof define==="function"&&define.amd)define(function(){return e});else this.riot=e})();
